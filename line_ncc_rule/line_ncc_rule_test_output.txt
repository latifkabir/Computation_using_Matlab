line_ncc_rule_test
10-Apr-2014 09:05:40

LINE_NCC_RULE_TEST
  MATLAB version:
  Test the LINE_NCC_RULE library.

LINE_NCC_RULE_TEST01
  LINE_NCC_RULE computes the Newton-Cotes (closed) rule
  using N equally spaced points for an interval [A,B].

  Newton-Cotes (Closed) Rule #1
   I       X(I)            W(I)

   1               1               2
        Sum(|W)|) =               2

  Newton-Cotes (Closed) Rule #2
   I       X(I)            W(I)

   1              -1               1
   2               1               1
        Sum(|W)|) =               2

  Newton-Cotes (Closed) Rule #3
   I       X(I)            W(I)

   1              -1        0.333333
   2               0         1.33333
   3               1        0.333333
        Sum(|W)|) =               2

  Newton-Cotes (Closed) Rule #4
   I       X(I)            W(I)

   1              -1            0.25
   2       -0.333333            0.75
   3        0.333333            0.75
   4               1            0.25
        Sum(|W)|) =               2

  Newton-Cotes (Closed) Rule #5
   I       X(I)            W(I)

   1              -1        0.155556
   2            -0.5        0.711111
   3               0        0.266667
   4             0.5        0.711111
   5               1        0.155556
        Sum(|W)|) =               2

  Newton-Cotes (Closed) Rule #6
   I       X(I)            W(I)

   1              -1        0.131944
   2            -0.6        0.520833
   3            -0.2        0.347222
   4             0.2        0.347222
   5             0.6        0.520833
   6               1        0.131944
        Sum(|W)|) =               2

  Newton-Cotes (Closed) Rule #7
   I       X(I)            W(I)

   1              -1        0.097619
   2       -0.666667        0.514286
   3       -0.333333       0.0642857
   4               0        0.647619
   5        0.333333       0.0642857
   6        0.666667        0.514286
   7               1        0.097619
        Sum(|W)|) =               2

  Newton-Cotes (Closed) Rule #8
   I       X(I)            W(I)

   1              -1       0.0869213
   2       -0.714286        0.414005
   3       -0.428571        0.153125
   4       -0.142857        0.345949
   5        0.142857        0.345949
   6        0.428571        0.153125
   7        0.714286        0.414005
   8               1       0.0869213
        Sum(|W)|) =               2

  Newton-Cotes (Closed) Rule #9
   I       X(I)            W(I)

   1              -1       0.0697707
   2           -0.75        0.415379
   3            -0.5      -0.0654674
   4           -0.25        0.740459
   5               0       -0.320282
   6            0.25        0.740459
   7             0.5      -0.0654674
   8            0.75        0.415379
   9               1       0.0697707
        Sum(|W)|) =         2.90243

  Newton-Cotes (Closed) Rule #10
   I       X(I)            W(I)

   1              -1       0.0637723
   2       -0.777778        0.351362
   3       -0.555556       0.0241071
   4       -0.333333        0.431786
   5       -0.111111        0.128973
   6        0.111111        0.128973
   7        0.333333        0.431786
   8        0.555556       0.0241071
   9        0.777778        0.351362
  10               1       0.0637723
        Sum(|W)|) =               2

  Newton-Cotes (Closed) Rule #11
   I       X(I)            W(I)

   1              -1       0.0536683
   2            -0.8        0.355072
   3            -0.6       -0.162087
   4            -0.4        0.909893
   5            -0.2        -0.87031
   6               0         1.42753
   7             0.2        -0.87031
   8             0.4        0.909893
   9             0.6       -0.162087
  10             0.8        0.355072
  11               1       0.0536683
        Sum(|W)|) =         6.12959

  Newton-Cotes (Closed) Rule #12
   I       X(I)            W(I)

   1              -1       0.0498665
   2       -0.818182        0.309711
   3       -0.636364      -0.0743385
   4       -0.454545        0.579317
   5       -0.272727       -0.220356
   6      -0.0909091        0.355801
   7       0.0909091        0.355801
   8        0.272727       -0.220356
   9        0.454545        0.579317
  10        0.636364      -0.0743385
  11        0.818182        0.309711
  12               1       0.0498665
        Sum(|W)|) =         3.17878

TEST02
  Use a sequence of NCC rules to compute an estimate Q
  of the integral:
    I = integral ( 0 <= x <= 1 ) exp(x) dx.
  The exact value is:
    I = 1.71828

   N       Q             |Q-I|

   1         2.71828               1
   2         1.85914        0.140859
   3         1.71886     0.000579323
   4         1.71854     0.000258325
   5         1.71828     8.59466e-07
   6         1.71828     4.84531e-07
   7         1.71828     1.05856e-09
   8         1.71828     6.50491e-10
   9         1.71828     1.50009e-11
  10         1.71828     5.59699e-11
  11         1.71828     2.44095e-10
  12         1.71828     4.64967e-09
  13         1.71828     1.13316e-08
  14         1.71828     1.37356e-07
  15         1.71828     8.53077e-07
  16         1.71828     2.23641e-06
  17         1.71825     2.68474e-05
  18         1.71836     8.02021e-05
  19         1.71663      0.00165085
  20         1.70869      0.00959075
  21         1.91569        0.197412
  22         3.09691         1.37863

LINE_NCC_RULE_TEST
  Normal end of execution.

10-Apr-2014 09:05:40
diary off
